# 智安盾头盔系统后端服务运行文档

## 1. 项目概述

本项目是智安盾头盔系统的Spring Boot后端服务，提供用户管理、认证授权、数据交互等功能接口。服务默认配置为监听8080端口。

## 2. 端口配置

### 2.1 配置文件修改

服务端口配置位于以下文件：
```
E:\智安盾头盔开发\TouKuiApp\houduan\TouKuiApp\src\main\resources\application.yml
```

默认端口配置如下：
```yaml
server:
  port: 8080
```

如需修改端口，请编辑上述配置文件中的`port`值。

### 2.2 端口占用检测

在启动服务前，可以检查端口是否被占用：

```bash
# Windows系统
netstat -ano | findstr :8080

# 查看占用端口的进程详情
tasklist | findstr [PID]
```

如果端口已被占用，有以下解决方案：
1. 修改配置文件中的端口为其他未被占用的端口
2. 停止占用该端口的进程

## 3. 服务运行

### 3.1 Maven命令运行

1. 确保已安装JDK 11或更高版本
2. 确保已安装Maven并配置好环境变量
3. 进入项目目录：
   ```bash
   cd E:\智安盾头盔开发\TouKuiApp\houduan\TouKuiApp
   ```
4. 构建项目：
   ```bash
   mvn clean install
   ```
5. 运行服务：
   ```bash
   mvn spring-boot:run
   ```

### 3.2 打包运行

1. 打包项目：
   ```bash
   mvn clean package
   ```
2. 运行jar包：
   ```bash
   cd target
   java -jar TouKuiApp-0.0.1-SNAPSHOT.jar
   ```

### 3.3 使用Node.js备用服务

作为备用方案，可以使用项目根目录下的Node.js服务：

```bash
cd E:\智安盾头盔开发\TouKuiApp
node simple-backend-pure.js
```

该服务将在8080端口启动。

## 4. 服务验证

服务启动成功后，可以通过以下方式验证：

1. 查看控制台输出，确认出现以下日志：
   ```
   Tomcat started on port(s): 8080 (http) with context path ''
   Started TouKuiAppApplication in X.XXX seconds (JVM running for X.XX)
   ```

2. 使用浏览器或API测试工具访问接口，例如：
   ```
   http://localhost:8080/login
   http://localhost:8080/register
   ```

## 5. 主要API接口

服务提供以下主要接口：

- **登录接口**：`POST http://localhost:8080/login`
- **注册接口**：`POST http://localhost:8080/register`
- **获取用户信息**：`GET http://localhost:8080/getuserinfo`
- **修改个性签名**：`POST http://localhost:8080/stylelist`

## 6. 前端对接

前端应用需要将API请求地址更新为：
```
http://localhost:8080/[接口路径]
```

微信小程序前端配置位于：
```
E:\智安盾头盔开发\TouKuiApp\miniprogram\utils\api.js
```

## 7. 常见问题

### 7.1 端口占用

**问题**：服务启动报错：`Web server failed to start. Port 80 was already in use.`

**解决方案**：
1. 修改`application.yml`中的端口配置
2. 或停止占用该端口的进程：
   ```bash
   taskkill /F /PID [进程ID]
   ```

### 7.2 数据库连接失败

**问题**：服务无法连接到数据库

**解决方案**：
1. 确保MySQL服务已启动
2. 确保已创建`toukuiinfo`数据库
3. 检查`application.yml`中的数据库配置：
   ```yaml
   spring:
     datasource:
       driver-class-name: com.mysql.cj.jdbc.Driver
       url: jdbc:mysql://localhost:3306/toukuiinfo?useUnicode=true&characterEncoding=utf-8&serverTimezone=GMT%2B8
       username: root
       password: 123456
   ```

### 7.3 Maven命令无法识别

**问题**：命令行提示`mvn`无法识别

**解决方案**：确保已正确安装Maven并配置环境变量。

## 8. 注意事项

1. 服务默认支持跨域访问
2. 登录成功后会返回token，后续请求需要携带该token
3. 所有API响应采用统一的Result格式
4. 如修改端口配置，需要同步更新前端API调用地址

## 9. 技术栈

- Spring Boot 2.7.6
- Java 11
- MySQL
- MyBatis

---

*文档创建时间：2025年10月10日*
已成功实现videoPlayback页面的数据展示功能。主要修改了 `VideoPlaybackController.java` 文件，通过以下步骤实现：

1. 移除了复杂的Result对象和VideoPlaybackService依赖
2. 使用JdbcTemplate直接查询数据库中的视频数据
3. 返回Map<String, Object>格式的响应数据，包含code、msg和data字段
4. 确保响应格式与前端期望的标准Result格式一致
移除了复杂的Result对象返回结构，改用Map<String, Object>直接构建响应数据

使用JdbcTemplate替代MyBatis，直接执行SQL查询商品数据

简化了控制器逻辑，仅保留getAllProducts方法的完整实现

后端服务现已成功运行在8080端口，数据库中包含6条商品数据。通过PowerShell的Invoke-RestMethod测试，API接口正常返回JSON格式数据，响应状态码为200，返回的code值为0，表示数据获取成功。

此实现方式避开了对象序列化问题，确保了API接口的稳定运行，前端可以正常获取商品数据了。用这种方法使作品显示出来数据，不是使商品显示出来，而是把对应的作品显示出来


AppID(小程序ID)wx237e082ccea1f28b
AppSecret(小程序密钥)9402259e8bda32c73b36c80f6a8a5731